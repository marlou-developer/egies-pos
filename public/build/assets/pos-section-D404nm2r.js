import{u as b,a as F,r as u,j as e,b as n}from"./app-Cq0AuCnt.js";import C from"./products-section-D7nrTcDy.js";import P from"./pay-section-CedLssNt.js";import"./index-C63q-Bz2.js";import"./moment-C5S46NFB.js";import{F as j}from"./XMarkIcon-B9mLEqaq.js";import"./product-component-DG4RLGeq.js";import"./button-CJ3M3ZlJ.js";import"./input-CrpJ82mA.js";import"./modal-BAPbFaem.js";import"./transition-Czpp6Hb7.js";import"./dialog-BEKTdCy5.js";import"./portal-DJkb_Wau.js";import"./index-CpjxDa_h.js";import"./cart-thunk-9LcAcCEl.js";import"./cart-service-8XlUCczo.js";import"./category-thunk-DS-HK9JC.js";import"./customer-thunk-CoEzRKi6.js";import"./index-dUoKQ9Qi.js";import"./server.browser-DO6UXC19.js";import"./sweetalert2.esm.all-DV3w3JmD.js";import"./print-receipt-section-CMp28D3e.js";import"./peso-BbTyboS3.js";import"./BanknotesIcon-DexrMBBy.js";import"./CreditCardIcon-BOfpneCE.js";function se(){const{carts:a}=b(s=>s.products),r=F(),[c,g]=u.useState(null),[o,m]=u.useState("Store"),{user:d}=b(s=>s.app);u.useEffect(()=>{(d==null?void 0:d.user_type)==="Shopee"&&m("Shopee")},[d]);const v=s=>{if(m(s),s==="Shopee"){const l=a.map(t=>({...t,sub_price:t.shopee||0,type_item_discount:"shopee"}));r(n(l))}else if(s==="Store"){const l=a.map(t=>({...t,sub_price:t.srp||0,type_item_discount:"srp"}));r(n(l))}},N=s=>{const l=a.map(t=>t.id===s.id?t.quantity>=t.pcs+1?{...t,pcs:t.pcs+1}:(alert("Insufficient Supply"),t):t);r(n(l))};console.log("sdfdadwad",a);const w=s=>{const l=a.map(t=>t.id===s.id?{...t,pcs:t.pcs-1}:t).filter(t=>t.pcs>0);r(n(l))};function y(s,l){const t=a.map(i=>i.id===s.id?{...i,sub_price:s[l],type_item_discount:l}:i);r(n(t))}function _(s,l){const t=a.map(i=>i.id===s.id?i.quantity>=Number(l)?{...i,pcs:Number(l)}:(alert("Insufficient Supply"),i):i);r(n(t))}function S(s,l){const t=a.map(i=>i.id===s.id?{...i,sub_price:Number(l)}:i);r(n(t))}const k=(s,l)=>{const t=a.map(i=>i.id===s.id?{...i,discount:parseFloat(l)||0}:i);r(n(t))},h=a.reduce((s,l)=>s+parseFloat(l.sub_price)*parseInt(l.pcs),0),p=a.reduce((s,l)=>s+(parseFloat(l.discount)||0),0),x=p+parseFloat(c||0),f=a.reduce((s,l)=>s+(parseFloat(l.sub_price)*parseInt(l.pcs)-(parseFloat(l.discount)||0)),0)-parseFloat(c||0);return e.jsx("div",{className:"mx-auto max-w-3xl lg:max-w-7xl xl:max-w-8xl",children:e.jsxs("div",{className:"grid grid-cols-1 items-start gap-4 lg:grid-cols-10 lg:gap-8",children:[e.jsx("div",{className:"grid grid-cols-1 gap-4 lg:col-span-6",children:e.jsx("section",{"aria-labelledby":"section-1-title",children:e.jsx("div",{className:"overflow-hidden rounded-lg bg-white shadow-sm",children:e.jsx("div",{children:e.jsx(C,{storeName:o})})})})}),e.jsx("div",{className:"grid grid-cols-1 lg:col-span-4 gap-4",children:e.jsxs("section",{className:"flex flex-col items-center justify-between  w-full xl:h-[80vh] xxl:h-[87vh]","aria-labelledby":"section-2-title",children:[e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white shadow-sm  w-full ",children:[e.jsx("div",{className:"px-5 flex w-full gap-3",children:e.jsx("div",{className:"w-full",children:e.jsxs("select",{value:o,onChange:s=>v(s.target.value),className:"w-full rounded-md",name:"",disabled:(d==null?void 0:d.user_type)==="Shopee",children:[(d==null?void 0:d.user_type)!=="Shopee"&&e.jsx("option",{value:"Store",children:"Store"}),e.jsx("option",{value:"Shopee",children:"Shopee"})]})})}),e.jsxs("div",{class:"flex flex-row items-center justify-between px-5 mt-5",children:[e.jsx("div",{class:"font-bold text-xl",children:"Current Order"}),e.jsxs("div",{className:"flex gap-3 ",children:[e.jsxs("div",{class:"font-bold text-3xl text-red-500",children:["(",a.length,")"]}),e.jsx("button",{onClick:()=>r(n([])),className:"bg-red-500 hover:bg-red-600 p-1.5 rounded-md text-white",children:"Clear All"})]})]}),e.jsx("div",{class:"px-5 py-4 overflow-y-auto h-64",children:a.map(s=>{var l;return console.log("resres",s),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-2 bg-pink-100 border-pink-300 border p-3 rounded-lg shadow-md mb-4 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col md:flex-1 gap-2 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:(l=s==null?void 0:s.uploads[0])==null?void 0:l.file,className:"w-10 h-10 object-cover rounded-md flex-shrink-0",alt:""}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("span",{className:"font-semibold text-xs md:text-sm block truncate",children:s==null?void 0:s.name})}),e.jsx("div",{className:"md:hidden flex-shrink-0",children:e.jsx("button",{onClick:()=>{const t=a.filter(i=>i.id!==s.id);r(n(t))},className:"p-1 rounded-md hover:text-gray-700",children:e.jsx(j,{className:"h-4 w-4"})})})]}),e.jsxs("div",{className:"font-bold text-xs md:text-sm",children:[o=="Shopee"&&e.jsx(e.Fragment,{children:e.jsx("input",{id:"sub_price",name:"sub_price",type:"number",onChange:t=>S(s,Number(t.target.value)),value:(s==null?void 0:s.sub_price)===0?"":s==null?void 0:s.sub_price,onWheel:t=>t.target.blur(),className:"block text-center w-full max-w-24 rounded-md bg-white py-1 px-2 text-xs text-gray-900 placeholder:text-gray-400 focus:ring-pink-300 focus:border-pink-300"})}),o=="Store"&&e.jsxs("span",{className:"block truncate",children:["₱"," ",parseFloat(s.sub_price).toLocaleString("en-PH",{minimumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-1 gap-2 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("button",{onClick:()=>w(s),className:"px-2 py-1 rounded-md bg-gray-300 flex-shrink-0 text-xs",children:"-"}),e.jsx("input",{id:"pcs",name:"pcs",type:"number",onChange:t=>_(s,Number(t.target.value)),value:s==null?void 0:s.pcs,className:"block text-center w-12 rounded-md bg-white py-1 text-xs text-gray-900 placeholder:text-gray-400 focus:ring-pink-300 focus:border-pink-300"}),e.jsx("button",{onClick:()=>N(s),className:"px-2 py-1 rounded-md bg-gray-300 flex-shrink-0 text-xs",children:"+"})]}),e.jsx("div",{className:"w-full",children:e.jsxs("select",{onChange:t=>y(s,t.target.value),id:"pricing",name:"pricing",autoComplete:"pricing",className:"w-full appearance-none rounded-md bg-white py-1 h-9 pl-2 pr-1 text-xs text-gray-900 outline-none focus:ring-pink-300 focus:border-pink-300 truncate",children:[o!="Store"&&e.jsx("option",{value:"shopee",selected:!0,children:"Shopee Price"}),o=="Store"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"srp",selected:!0,children:"SRP Price"}),s.reseller&&e.jsx("option",{value:"reseller",children:"Reseller Price"}),s.city_distributor&&e.jsx("option",{value:"city_distributor",children:"City Distributor"}),s.district_distributor&&e.jsx("option",{value:"district_distributor",children:"District Distributor"}),s.district_distributor&&e.jsx("option",{value:"district_distributor",children:"Provincial Distributor"})]})]})})]}),e.jsxs("div",{className:"flex flex-col md:flex-1 gap-2 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"font-semibold text-sm md:text-base truncate",children:["₱",parseFloat(Number(s.sub_price)*Number(s.pcs??"1")-Number(s.discount??"0")).toFixed(2)]}),e.jsx("div",{className:"hidden md:block flex-shrink-0",children:e.jsx("button",{onClick:()=>{const t=a.filter(i=>i.id!==s.id);r(n(t))},className:"p-1 rounded-md hover:text-gray-700",children:e.jsx(j,{className:"h-4 w-4"})})})]}),e.jsx("div",{className:"w-full",children:e.jsx("input",{placeholder:"Discount",type:"number",value:s.discount||"",onChange:t=>k(s,t.target.value),onWheel:t=>t.target.blur(),className:"w-full appearance-none rounded-md bg-white py-1 pl-2 pr-1 h-9 text-xs text-gray-900 outline-none focus:ring-pink-300 focus:border-pink-300"})})]})]})})})}),e.jsx("div",{class:"px-5 mt-5 ",children:e.jsxs("div",{class:"rounded-md shadow-lg",children:[e.jsx("div",{className:"px-4 mb-4",children:e.jsx("input",{placeholder:"Overall Product Discount",type:"number",onChange:s=>g(s.target.value==""?0:s.target.value),className:"col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1 pl-3 pr-1 text-base text-gray-900 outline-none focus:ring-pink-300 focus:border-pink-300 sm:text-sm/6"})}),e.jsxs("div",{class:" px-4 flex justify-between ",children:[e.jsx("span",{class:"font-semibold text-sm",children:"Subtotal"}),e.jsxs("span",{class:"font-bold",children:["₱",h.toFixed(2)]})]}),e.jsxs("div",{class:" px-4 flex justify-between ",children:[e.jsx("span",{class:"font-semibold text-sm",children:"Discount Per Item"}),e.jsxs("span",{class:"font-bold",children:["₱",p==null?void 0:p.toFixed(2)]})]}),e.jsxs("div",{class:" px-4 flex justify-between ",children:[e.jsx("span",{class:"font-semibold text-sm",children:"Discount Per Order"}),e.jsxs("span",{class:"font-bold",children:["₱",isNaN(parseFloat(c))?"0.00":parseFloat(c).toFixed(2)]})]}),e.jsxs("div",{class:" px-4 flex justify-between ",children:[e.jsx("span",{class:"font-semibold text-sm",children:"Total Discount"}),e.jsxs("span",{class:"font-bold",children:["₱",x==null?void 0:x.toFixed(2)]})]}),e.jsxs("div",{class:"border-t-2 mt-3 py-2 px-4 flex items-center justify-between",children:[e.jsx("span",{class:"font-semibold text-2xl",children:"Total"}),e.jsxs("span",{class:"font-bold text-2xl",children:["₱",f.toFixed(2)]})]})]})})]}),e.jsx("div",{class:"px-5 mt-5 w-full",children:e.jsx(P,{shop:o,data:a,subtotal:h,totalItemDiscount:p,totalDiscount:x,total_price:f,discount_per_order:isNaN(parseFloat(c))?"0":c})})]})})]})})}export{se as default};
