import{r as s,b as L,j as o,v as M}from"./app-Dy7EG4_D.js";import{B as w}from"./button-CAUIEwaA.js";import{M as B}from"./modal-DA_CGck7.js";import"./index-BVTivL0H.js";import"./server.browser-D8BRlS8r.js";import"./sweetalert2.esm.all-DV3w3JmD.js";import F from"./print-receipt-section-DQJL6pik.js";import"./dialog-JhNTD7H6.js";import"./portal-D5Igh6qP.js";import"./transition-BTj6BnkI.js";import"./index-Utu_5D7Z.js";import"./XMarkIcon-DA-kNP7U.js";import"./peso-BbTyboS3.js";import"./moment-C5S46NFB.js";function ot({total_price:h,totalItemDiscount:g,subtotal:x,totalDiscount:S,discount_per_order:b,data:a,shop:y}){var _,f;const[O,j]=s.useState(!1),[c,i]=s.useState(!1),[R,v]=s.useState(null),[D,$]=s.useState(!1),[P,k]=s.useState(!1),[t,r]=s.useState({customer_amount:null,change:0,payment_type:null}),[C,q]=s.useState(null),N=L(),[I,z]=s.useState(0),E=(((_=t==null?void 0:t.customer)==null?void 0:_.discounts)??[]).reduce((e,n)=>(e[n.product_id]=n,e),{}),l=a.map(e=>{const n=E[e.id];return n?{...e,...n}:e}),d=l.map(e=>e.customer_discount?e:null).filter(e=>e!==null),u=d.reduce((e,n)=>e+Number(n.customer_discount)*Number(n.pcs),0),m=h-u;s.useEffect(()=>{t.is_credit&&r({...t,customer_amount:m,change:0})},[t.is_credit]);function p(e){j(!1),i(!1),r({customer_amount:null,change:0,payment_type:null}),v(null)}s.useEffect(()=>{c||p()},[c]);const A={customer_amount:t.customer_amount,change:t.change,payment_type:t.is_credit?null:t.payment_type,cart_items:l,total_price:m,customer_total_discount:u??0,discount_per_order:b,total_item_discount:g,sub_total:x,total_discount:S+(u??0),is_credit:`${t==null?void 0:t.is_credit}`??null,due_date:(t==null?void 0:t.due_date)??null,customer_id:((f=t==null?void 0:t.customer)==null?void 0:f.id)??null,shop:y,order_id:t.order_id??null,customer_name:t.customer_name??null};return console.log("list_of_available_discount",d),o.jsxs(o.Fragment,{children:[o.jsx(w,{disabled:a.length==0,onClick:()=>i(!0),className:"w-full bg-pink-500 hover:bg-pink-600",children:"Add Product Sales"}),P&&o.jsx(F,{id:I,productId:C,reset1:()=>N(M([])),reset2:()=>p(),data:A,onPrinted:()=>k(!1)}),o.jsx(B,{onClose:()=>i(!1),isOpen:c,title:"Add Product Sales",children:o.jsxs("div",{children:[o.jsx("div",{children:"Are you sure to add this product(s) to sales?"}),o.jsxs("div",{className:"flex items-center justify-end gap-4 mt-4",children:[o.jsx("button",{onClick:()=>i(!1),className:"text-sm hover:text-gray-700 text-gray-500",children:"Cancel"}),o.jsx("button",{className:"text-sm bg-pink-500 text-white px-4 py-2 rounded hover:bg-pink-600 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2",children:"Submit"})]})]})})]})}export{ot as default};
