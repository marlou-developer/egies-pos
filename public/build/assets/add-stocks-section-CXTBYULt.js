import{h as g,r as a,u as v,j as e,s as c}from"./app-CqZavfFk.js";import{v as j}from"./index-BPqe6Zi-.js";import{M as y}from"./Modal-Be7SA3TB.js";import{I as d}from"./input-CJRNs19y.js";import{g as b}from"./product-thunk-BMvfgeLD.js";import{b as S}from"./cart-thunk-DedJwfyC.js";import{s as h}from"./index-BlwDC1xm.js";import"./index-CqvK6DSm.js";import"./transition-Vwvbzsu5.js";import"./dialog-CmcBWsGC.js";import"./portal-BnH52ISR.js";import"./index-B3uTRTNc.js";import"./XMarkIcon-BbmpCL82.js";import"./cart-service-Be_Mzos8.js";import"./useZIndex-DC5eSuSW.js";import"./UnstableContext-DT81vMve.js";import"./KeyCode-C40MO73N.js";function k(t){try{return g.post("/api/stock",t)}catch{}}function _(t){return async function(o,l){await k(t)}}function B({data:t}){const[o,l]=a.useState(!1),[i,u]=a.useState("same"),[N,p]=a.useState(!1),[s,n]=a.useState({}),{suppliers:m}=v(r=>r.suppliers),f=async r=>{r.preventDefault(),p(!0);try{await c.dispatch(_({...s,product_id:String(t==null?void 0:t.id),price:i==="same"?t==null?void 0:t.cost:null,remaining:String(t==null?void 0:t.quantity)})),await c.dispatch(S()),await c.dispatch(b()),h.success("Successfully added!"),l(!1),n({}),u("same")}catch{h.error("Failed to add stock. Please try again.")}finally{p(!1)}};return console.log("suppliers",m),e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:()=>l(!0),className:"relative inline-flex items-center rounded-md bg-pink-100 w-full px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-gray-300 ring-inset hover:bg-pink-200 ",children:[e.jsx(j,{className:"mr-1 text-pink-500"}),"Add Stocks"]}),e.jsx(y,{open:o,setOpen:l,children:e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"mt-6 flex flex-col gap-5",children:[e.jsx("h1",{className:"font-bold text-xl text-pink-500",children:"Add Stock(s)"}),e.jsx("div",{children:e.jsx(d,{onChange:r=>n({...s,date:r.target.value}),value:s.date||"",name:"date",label:"Delivery Date",type:"date",required:!0})}),e.jsx("div",{children:e.jsx(d,{onChange:r=>n({...s,delivery_id:r.target.value}),value:s.delivery_id||"",name:"delivery_id",label:"Delivery ID",type:"text",required:!0})}),e.jsx("div",{children:e.jsx(d,{onChange:r=>n({...s,quantity:r.target.value}),value:s.quantity||"",name:"quantity",label:"Quantity",type:"number",required:!0})}),e.jsx("div",{children:e.jsxs("select",{value:i,onChange:r=>u(r.target.value),className:"w-full rounded-md border-gray-500 text-sm h-11",children:[e.jsx("option",{disabled:!0,selected:!0,children:"Pricing"}),e.jsxs("option",{value:"same",children:["Same cost price = ₱",parseFloat(t==null?void 0:t.cost).toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsx("option",{value:"different",children:"Different cost price"})]})}),e.jsx("div",{children:e.jsxs("select",{value:s==null?void 0:s.supplier_id,onChange:r=>n({...s,supplier_id:r.target.value}),className:"w-full rounded-md border-gray-500 text-sm h-11",children:[e.jsx("option",{disabled:!0,selected:!0,children:"Select Supplier"}),m.map((r,x)=>e.jsx("option",{value:r.id,children:r.name},x))]})}),i==="different"&&e.jsxs("p",{className:"text-sm text-gray-600",children:["If cost price is different from the current cost price, ",e.jsx("a",{href:"/administrator/products",className:"text-pink-500 underline",children:"Add Product"})," ","instead."]})]}),e.jsx("div",{className:"mt-3 w-full",children:e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("button",{type:"submit",disabled:i==="different",className:`rounded-md p-2 text-white transition 
        ${i==="different"?"bg-gray-300 cursor-not-allowed":"bg-pink-400 hover:bg-pink-500"}
    `,children:"Add Stock"})})})]})})]})}export{B as default};
